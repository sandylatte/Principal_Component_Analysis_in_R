---
title: "Principal Component Analysis"
output: html_notebook
---

# 0. LOAD LIBRARY

```{r}
rm(list = ls()) #to clear objects from workspace
library(psych) #describe function
source('https://raw.githubusercontent.com/vqv/ggbiplot/master/R/ggbiplot.r') #pca function
```

# 1, EXTRACT, TRANSFORM, LOAD (ETL)

## 1.1 Data Load

```{r Load Data}
df <- read.csv("mtcars.csv")
print(head(df))
```

## 1.2 Data Dictionary

mpg: Fuel consumption (Miles per (US) gallon): more powerful and heavier cars tend to consume more fuel.
cyl: Number of cylinders: more powerful cars often have more cylinders
disp: Displacement (cu.in.): the combined volume of the engine’s cylinders
hp: Gross horsepower: this is a measure of the power generated by the car
drat: Rear axle ratio: this describes how a turn of the drive shaft corresponds to a turn of the wheels. Higher values will decrease fuel efficiency.
wt: Weight (1000 lbs): pretty self-explanatory!
qsec: 1/4 mile time: the cars speed and acceleration
vs: Engine block: this denotes whether the vehicle’s engine is shaped like a “V”, or is a more common straight shape.
am: Transmission: this denotes whether the car’s transmission is automatic (0) or manual (1).
gear: Number of forward gears: sports cars tend to have more gears.
carb: Number of carburetors: associated with more powerful engines
additionally external added country denotes the original country that design the cars Note that the units used vary and occupy different scales.

total data: **32 observations**


## 2. FEATURE ENGINEERING

## 2.1 Feature Engineeering

### 2.1.1 Remove unnecessary feature

### 2.1.2 Add new feature

## 2.2 Check if there is NULL VALUE

```{r NULL value}
colSums(is.na(df))
```
### 2.2.1 Imputing Data

## 2.3 Check Unary Data

```{r Unary Data}
apply(df[c(-1, -ncol(df))], 2, max) - apply(df[c(-1, -ncol(df))], 2, min)
```
# 3. EXPLORARTORY DATA ANALYSIS (EDA)

# 3.1 Decriptive Statistic

```{r Summary}
summary(df)
```

```{r Correlation}
#carb is only an example target
#cor(df[c(-1, -ncol(df))], df[12]) ##first method
correlation <- as.data.frame(cor(df[c(-1, -ncol(df))]))
print(correlation)
#print(correlation["carb"])
```

```{r Kurtosis and Skewness}
describe(df)[c("kurtosis", "skew")]
```

## 3.2 Visualization

```{r}
plot(df$mpg, df$wt,
     pch = 20)
```

```{r}
plot(df$cyl, df$disp,
     pch = 20)
```

# 4. FITTING / MODELING

# 4.1 Splitting

Unnecessary because we don't calculate accuracy.

# 4.2 Modeling

```{r remove no variance feature}
#shoudnt be processed for feature that has no variance (at least 3 categories should be fine)
df1 <- df[c(2:8, 11:12)]
head(df1)
```

```{r}
pca <- prcomp(df1, center = TRUE, scale. = TRUE)
```

Cumulative Proportion should be > 0.8 to be visualized well

# 5 Model Performance

# 5.1 Inferential Statistics

```{r}
summary(pca)
```

# 5.2 Visualization Approach

```{r}
ggbiplot(pca,
         labels = df$model,
         groups = df$country,
         ellipse = TRUE)
```

PCA seeks anomalies = the one that is moving away from the center.
Anomalies = far from the mean value

# 6. Prediction

Unnecessary.

# 7. Prescription
